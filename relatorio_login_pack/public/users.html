<!doctype html><html lang='pt-BR'><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'><title>Usuários</title><style>body{font-family:Arial;margin:0;background:#fafafa}header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #e5e7eb;background:#fff}.container{padding:16px}table{border-collapse:collapse;width:100%;background:#fff;border:1px solid #e5e7eb;border-radius:10px;overflow:hidden}th,td{padding:10px;border-bottom:1px solid #eee;text-align:left;font-size:14px}th{background:#f8fafc}input,select{padding:8px 10px;border:1px solid #cbd5e1;border-radius:10px;font-size:14px}button{appearance:none;border:1px solid #cbd5e1;background:#fff;padding:10px 14px;border-radius:10px;font-size:14px;cursor:pointer}.primary{background:#2f5597;color:#fff;border-color:#2f5597}.row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px}</style></head><body><header><div><b>Gestão de Usuários</b></div><div><button id='btnApp'>Ir para o App</button> <button id='btnSair'>Sair</button></div></header><div class='container'><div class='row'><input id='name' placeholder='Nome'><input id='email' placeholder='E-mail'><input id='password' type='password' placeholder='Senha'><select id='role'><option value='user'>Usuário</option><option value='admin'>Admin</option></select><button class='primary' id='btnAdd'>Adicionar</button></div><table><thead><tr><th>ID</th><th>Nome</th><th>E-mail</th><th>Papel</th><th>Ações</th></tr></thead><tbody id='tbody'></tbody></table></div><script type='module'>import{ensureAuth,api,clearToken}from'./auth.js';const me=await ensureAuth();if(me?.role!=='admin'){alert('Apenas administradores.');location.href='/app.html'}document.getElementById('btnApp').onclick=()=>location.href='/app.html';document.getElementById('btnSair').onclick=()=>{clearToken();location.href='/login.html'};async function load(){const r=await api('GET','/api/users');const d=await r.json();const tb=document.getElementById('tbody');tb.innerHTML='';(d.users||[]).forEach(row=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${row.id}</td><td>${row.name}</td><td>${row.email}</td><td>${row.role}</td><td><button data-id='${row.id}' class='btnDel'>Excluir</button></td>`;tb.appendChild(tr)})}document.getElementById('btnAdd').onclick=async()=>{const name=document.getElementById('name').value.trim(),email=document.getElementById('email').value.trim(),password=document.getElementById('password').value,role=document.getElementById('role').value;if(!name||!email||!password)return alert('Preencha os campos');const r=await api('POST','/api/users',{name,email,password,role});if(!r.ok){const d=await r.json();return alert('Falha: '+(d?.error||r.status))}document.getElementById('name').value='';document.getElementById('email').value='';document.getElementById('password').value='';await load()};document.getElementById('tbody').addEventListener('click',async e=>{const btn=e.target.closest('.btnDel');if(!btn)return;if(!confirm('Excluir este usuário?'))return;const id=btn.getAttribute('data-id');const r=await api('DELETE','/api/users/'+id);if(!r.ok){const d=await r.json();return alert('Falha: '+(d?.error||r.status))}await load()});load();</script></body></html>